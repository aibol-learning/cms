<script>
    $(function () {
        // 悬浮窗口
        $(".yb_conct").hover(function () {
            $(".yb_conct").css("right", "5px");
            $(".yb_bar .yb_ercode").css('height', '240px');
        }, function () {
            $(".yb_conct").css("right", "-127px");
            $(".yb_bar .yb_ercode").css('height', '53px');
        });

        // 返回顶部
        $(".yb_top").click(function () {
            $("html,body").animate({
                'scrollTop': '0px'
            }, 300)
        });

        //访问统计
        vm = new Vue({
            el: "#vm_siteVisitData",
            data: {
                siteVisitData: {    //站点访问量数据
                    todayPV: null,  //站点日访问量
                    avgPV: null,    //站点平均访问量
                    totalPV: null   //站点总访问量
                },  
                site: 'major'       //站点访问量统计的站点标识 
            },
            methods: {
                //获取站点日访问量数据
                getTodayPV: function () {
                    var self = this;
                    $.ajax({
                        url: '/api/aibol/addpv?site=' + self.site,
                        type: 'get',
                        success: function (response) {
                            if (response.code == 200 && response.data) {
                                self.siteVisitData.todayPV = response.data;
                            }
                        }
                    })
                },

                //获取站点平均访问量数据
                getAvgPV: function () {
                    var self = this;
                    $.ajax({
                        url: '/api/aibol/GetAvgPV?site=' + self.site,
                        type: 'get',
                        success: function (response) {
                            if (response.code == 200 && response.data) {
                                self.siteVisitData.avgPV = response.data;
                            }
                        }
                    });
                },

                //获取站点总访问量数据
                getTotalPV: function () {
                    var self = this;
                    $.ajax({
                        url: '/api/aibol/GetTotalPV?site=' + self.site,
                        type: 'get',
                        success: function (response) {
                            if (response.code == 200 && response.data) {
                                self.siteVisitData.totalPV = response.data;
                            }
                        }
                    });
                },

                //添加站点访问量数据
                setPV: function () {
                    var self = this;
                    $.ajax({
                        url: '/api/aibol/addpv?site=' + self.site,
                        type: 'get',
                        success: function (response) {
                            if (response.code == 200) {
                                self.getTodayPV();
                                self.getAvgPV();
                                self.getTotalPV();
                            }
                        }
                    });
                }
            },
            created: function () {
                var self = this;

                //站点访问量数据设置
                this.setPV();
            }
        })
    });
</script>